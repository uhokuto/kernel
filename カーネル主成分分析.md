# カーネル主成分分析

$m$次元データを高次元$\Phi$に写像した空間で主成分分析を行うもの。一般の主成分分析は、主成分ベクトル上に射影したデータ点の分散を最大化するものだが、カーネル主成分分析の場合、主成分ベクトルは再生核ヒルベルト空間上の関数$f$で与えられる。したがってカーネル主成分分析における分散最大化とは、写像空間$\Phi$上のデータ$X_i$を$f$に射影した点の分散を最大化する問題として以下のように定式化できる。



**1. カーネル主成分分析評価関数**       $\displaystyle\max_{|\|f\|=1}\frac{1}{N}\sum_{i=1}^{N}\langle f,\tilde{\Phi}(X_i) \rangle^2$      (1)



ここで、$\tilde{\Phi}(X_i)=\Phi(X_i) - \frac{1}{N}\sum_{j=1}^N\Phi(X_j)$、すなわち写像空間$\Phi$におけるデータ$X_i$の平均からの偏差である。上式の内積部分は、偏差ベクトルを$f$に射影した点の分散を意味する。また$f$は単位ベクトル$\|f\|=1$である。



空間$\Phi$は高次元空間であるものの、$f$**は、この空間において線形な部分空間である！**

すなわち、

            $\displaystyle f=\sum_{i=1}^Na_i \tilde{\Phi}(X_i)$         (2)

このことは、$f$の直交分解$f=f_0 \bigotimes f_{\perp}$から証明できる。（カーネル法入門 p.6）

$X_i$**は観測データでgiven, $\tilde{\Phi}(X_i)$は元データ空間を非線形写像した空間でのベクトルだから、$f$はこの写像空間でのベクトルを$a_i$で線形結合したもの、つまり部分空間であり、$f$は線形である。**



**2. カーネル主成分分析評価関数の最適化**

$f$が線形であるという前提のもとで、カーネル主成分分析評価関数の最適化は、普通の主成分分析と同様に以下のような固有値を求める問題に帰着できる。

$\max b^T\tilde{K}b$    subject to $\|b\|=1$ 

ここで、$\tilde{K}$は$N\times N$のカーネル行列で、その要素は、$\tilde{K}_{ij}=\langle \tilde{\Phi}(X_i),\tilde{\Phi}(X_j) \rangle$また、

$b=\tilde{K}^{1/2}a$とする。重要なポイントを述べる

**(1)   主成分分析での最適化では、共分散行列だったものが、カーネル主成分分析では、$\tilde{K}$にすり替わったものと言える**。

**(2)  $\tilde{K}_{ij}=\langle \tilde{\Phi}(X_i),\tilde{\Phi}(X_j) \rangle$は、まともに内積計算すると計算量が膨大になるが、$\langle \Phi(X_i), \Phi(X_j) \rangle = k(X_i, X_j)$、つまり写像の内積がカーネルならば（再生核ヒルベルト空間上のカーネル）、$\tilde{K}_{ij}$はカーネル$k$の演算で済む（カーネル法入門 p.7 (1.8) ）。**



この固有値問題を解くと、最適解、すなわち主成分ベクトル$f$の第１主成分ベクトル$a$   (2)式(=第１固有ベクトル）は、

      第1主成分ベクトル :  $a=(1/\sqrt{\lambda_1})u^1$  : **写像空間$\Phi$において線形**

ここで、$u, \lambda$は、それぞれ、$\tilde{K}$の固有値分解$\tilde{K}=U\Lambda U$で得られる$U$（直交行列=固有ベクトル行列）の第1ベクトル、$\Lambda$（固有値対角行列）の第1対角要素である。

また、写像空間での$X_i$の第1主成分は、$\tilde{\Phi}(X_i)$の$f$への射影なので、

       第1主成分 :  $\langle \tilde{\Phi}(X_i),f \rangle =\sqrt{\lambda_1}u_i^1$

で表せる。

同様にして、$X_i$の第p主成分は

      第p主成分 :   $\langle \tilde{\Phi}(X_i),f^{(p)} \rangle =\sqrt{\lambda_p}u_i^p$

で表される。




